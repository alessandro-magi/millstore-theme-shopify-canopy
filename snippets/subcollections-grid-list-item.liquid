{% comment %} Assign object as block or section {% endcomment %}

{%- liquid
  unless collection == empty
    assign first_product_image = collection.all_products.first.featured_media.preview_image
    if image == blank and use_product_image and first_product_image
      assign image = first_product_image
    elsif image == blank and collection.featured_image
      assign image = collection.featured_image
    endif
  endunless

  if image_ratio == nil
    if section.settings.card_image_ratio == 'shortest' or section.settings.card_image_ratio == 'tallest' or section.settings.card_image_ratio == 'circle' or circle_image
      assign image_ratio = 1
    else
      assign image_ratio = section.settings.card_image_ratio
    endif
  elsif image_ratio == 0 or image_ratio == 99
    assign image_ratio = 1
  endif

  unless circle_image
    if settings.coll_card_image_ratio == 'circle'
      assign circle_image = true
    endif
  endunless

  unless show_border == false
    assign show_border = true
  endunless
-%}

{% if type == 'block' %}
  {%- assign object = block -%}
{% else %}
  {%- assign object = section -%}
{% endif %}

{% assign collection_title = 'onboarding.collection.title' | t %}

{% unless onboard %}
  {% assign current_collection = link.object %}

  {% if current_collection == blank %}
    {% continue %}
  {% endif %}

  {% assign collection_title = current_collection.title %}

  {% assign current_collection = link.object %}
  {% if current_collection == blank %}
    {% continue %}
  {% endif %}

  {% if current_collection.image and object.settings.thumbnail_image == 'collection-image' %}
    {% assign collection_image = current_collection.image %}
  {% else %}
    {% assign collection_image = current_collection.products.first.featured_media.preview_image %}
  {% endif %}
{% endunless %}
          
              <li class="subcollections-grid__item" data-subcollections-grid-item {% if block %}{{ block.shopify_attributes }}{% endif %}>
                <a href="{{ current_collection.url }}">
                  <figure class="subcollections-grid__item-image">
                      {% unless onboard or collection_image == blank %}
                        {% render 'image',
                          image: collection.image,
                          alt: collection_image.alt,
                          widths: '320, 460, 600, 700, 800, 900, 1200',
                          src_width: 460,
                          src_placeholder: true,
                          sizes: sizes,
                          class: class,
                          disable_focal_point: true,
                          attr: 'data-collection-image'
                        %}
                      {% else %}
                        {%- capture index -%}
                          {%- cycle '1', '2', '3', '4', '5', '6' -%}
                        {%- endcapture -%}
                        {{ 'collection-' | append: index | placeholder_svg_tag: 'placeholder--image' }}
                      {% endunless %}
                  </figure>

                  <span class="subcollections-grid__item-info subcollections-grid__item-title">
                    {{ collection_title }} {% if show_product_count %}({{ current_collection.all_products_count }}) {% endif %}
                  </span>
                </a>
              </li>
 